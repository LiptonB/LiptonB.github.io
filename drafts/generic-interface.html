<!DOCTYPE html>
<html lang="en">

<head>
      <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="canonical" href="http://blog.benjaminlipton.com/drafts/generic-interface.html" />

    <title>  bl stash save &mdash; Generating arbitrary CSR extensions with Openssl
</title>




    <link rel="stylesheet" href="http://blog.benjaminlipton.com/theme/css/style.css">

    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->


    <meta name="author" content="Benjamin Lipton">
    <meta name="description" content="[root@vm-058-019 freeipa]# ipa certmappingrule-add GenericSAN Description of this mapping rule: subject alt name using generic interface Certificate Mapping Rule ID: GenericSAN Description of this mapping rule: subject alt name using generic interface [root@vm-058-019 freeipa]# ipa certmappingrule-add GenericDNS Description of this mapping rule: DNS subject alt name using generic ...">
  <meta name="tags" contents="">
</head>

<body>
<header class="header">
  <div class="container">
    <div class="header-inner">
      <h1 class="header-name">
        <a class="nodec" href="http://blog.benjaminlipton.com">bl stash save</a>
      </h1>
      <h3 class="header-text"></h3>
      <ul class="header-menu list-inline">
          <li><a class="nodec icon-github" href="https://github.com/LiptonB"></a></li>
      </ul>
    </div>
  </div>
</header> <!-- /.header -->  <div class="container">
  <div class="post full-post">
    <h1 class="post-title">
      <a href="/drafts/generic-interface.html" title="Permalink to Generating arbitrary CSR extensions with Openssl">Generating arbitrary CSR extensions with Openssl</a>
    </h1>
    <ul class="list-inline">
      <li class="post-date">
        <a class="text-muted" href="/drafts/generic-interface.html" title="2016-08-08T00:00:00-04:00">Mon 08 August 2016</a>
      </li>
      <li class="muted">&middot;</li>
      <li class="post-category">
        <a href="http://blog.benjaminlipton.com/category/freeipa.html">freeipa</a>
      </li>
    </ul>
    <div class="post-content">
      <div class="toc">
<ul></ul>
</div>
<div class="highlight"><pre><span></span><span class="o">[</span>root@vm-058-019 freeipa<span class="o">]</span><span class="c1"># ipa certmappingrule-add GenericSAN</span>
Description of this mapping rule: subject alt name using generic interface
  Certificate Mapping Rule ID: GenericSAN
  Description of this mapping rule: subject alt name using generic interface
<span class="o">[</span>root@vm-058-019 freeipa<span class="o">]</span><span class="c1"># ipa certmappingrule-add GenericDNS</span>
Description of this mapping rule: DNS subject alt name using generic interface
  Certificate Mapping Rule ID: GenericDNS
  Description of this mapping rule: DNS subject alt name using generic interface
<span class="o">[</span>root@vm-058-019 freeipa<span class="o">]</span><span class="c1"># ipa certtransformationrule-add GenericSAN</span>
Certificate Transformation Rule ID: GenericSANOpenssl
String defining the transformation: <span class="o">{</span>% <span class="nb">set</span> <span class="nv">extension</span> <span class="o">=</span> <span class="nb">true</span> %<span class="o">}</span>2.5.29.17<span class="o">=</span>ASN1:SEQUENCE:<span class="o">{</span>% call openssl.section<span class="o">()</span> %<span class="o">}{{</span> datarules<span class="p">|</span>join<span class="o">(</span><span class="s1">&#39;\n&#39;</span><span class="o">)</span> <span class="o">}}{</span>% endcall %<span class="o">}</span>                          
Name of CSR generation helper: openssl
  Certificate Transformation Rule ID: GenericSANOpenssl
  String defining the transformation: <span class="o">{</span>% <span class="nb">set</span> <span class="nv">extension</span> <span class="o">=</span> <span class="nb">true</span> %<span class="o">}</span>2.5.29.17<span class="o">=</span>ASN1:SEQUENCE:<span class="o">{</span>% call openssl.section<span class="o">()</span> %<span class="o">}{{</span> datarules<span class="p">|</span>join<span class="o">(</span><span class="s1">&#39;\n&#39;</span><span class="o">)</span> <span class="o">}}{</span>% endcall %<span class="o">}</span>
  Name of CSR generation helper: openssl
<span class="o">[</span>root@vm-058-019 freeipa<span class="o">]</span><span class="c1"># ipa certtransformationrule-add GenericDNS</span>
Certificate Transformation Rule ID: GenericDNSOpenssl
String defining the transformation: <span class="nv">dns</span><span class="o">=</span>EXPLICIT:2,IA5STRING:<span class="o">{{</span> ipa.datafield<span class="o">(</span>subject.krbprincipalname.0<span class="p">|</span>safe_attr<span class="o">(</span><span class="s2">&quot;hostname&quot;</span><span class="o">))</span> <span class="o">}}</span>
Name of CSR generation helper: openssl
  Certificate Transformation Rule ID: GenericDNSOpenssl
  String defining the transformation: <span class="nv">dns</span><span class="o">=</span>EXPLICIT:2,IA5STRING:<span class="o">{{</span> ipa.datafield<span class="o">(</span>subject.krbprincipalname.0<span class="p">|</span>safe_attr<span class="o">(</span><span class="s2">&quot;hostname&quot;</span><span class="o">))</span> <span class="o">}}</span>
  Name of CSR generation helper: openssl
<span class="o">[</span>root@vm-058-019 freeipa<span class="o">]</span><span class="c1"># ipa certprofile-show --out /tmp/out --mappings-out /tmp/mappings-out caIPAserviceCert</span>
  Profile ID: caIPAserviceCert
  Profile description: Standard profile <span class="k">for</span> network services
  Store issued certificates: TRUE
  Profile configuration stored to: /tmp/out
  Mapping rules stored to: /tmp/mappings-out
<span class="o">[</span>root@vm-058-019 freeipa<span class="o">]</span><span class="c1"># vim /tmp/out  # Remove profileId</span>
<span class="o">[</span>root@vm-058-019 freeipa<span class="o">]</span><span class="c1"># vim /tmp/mappings-out  # Change to the &quot;generic&quot; mapping rules</span>
<span class="o">[</span>root@vm-058-019 freeipa<span class="o">]</span><span class="c1"># ipa certprofile-import --file /tmp/out --mappings-file /tmp/mappings-out genericSAN</span>
Profile description: Host profile using generic interface
Store issued certificates <span class="o">[</span>True<span class="o">]</span>: 
-----------------------------
Imported profile <span class="s2">&quot;genericSAN&quot;</span>
-----------------------------
  Profile ID: genericSAN
  Profile description: Host profile using generic interface
  Store issued certificates: TRUE
</pre></div>
    </div>
  </div>
  <hr class="separator">
  <div class="col-md-8 col-md-offset-2">
  </div>
  </div>
<footer class="footer">
  <div class="container">
    <p class="text-center">
      Benjamin Lipton, <a href="" target="_blank"></a> unless otherwise noted.
    </p>
    <div class="text-center">
      Generated by <a href="http://getpelican.com" target="_blank">Pelican</a> with the <a href="http://github.com/nairobilug/pelican-alchemy">alchemy</a> theme.
    </div>
  </div>
</footer> <!-- /.footer -->
  <script src="http://blog.benjaminlipton.com/theme/js/jquery.min.js"></script>
  <script src="http://blog.benjaminlipton.com/theme/js/bootstrap.min.js"></script>
</body> <!-- 42 -->

</html>